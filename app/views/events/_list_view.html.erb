<%
    mobile ||= false
    markerSize ||= "medium"
    dimension ||= 30
%>

<%if (mobile == true)
    markerSize = "small"
    dimension = 16%>
<% end %>

<% if (@neighborhood == nil) %>
    <h2>events near </h2>
    <h1><%= link_to("King County", "/neighborhoods") %></h1>
<% else %>
    <h2>events near</h2>
    <h1><%= link_to(@neighborhood.name, "/neighborhoods") %></h1>
<% end %>
<% if (@events.count == 0) %>
    <p>There are no events in this location.  Try a different neighborhood.</p>
<% else %>
    <% @events.each_with_index do |event, i| %>
    <div class="event_with_marker event" onclick="Map.showPopup(<%= event.id %>);">
        <div class="pull-left marker"
             style="background: url(<%= event.attending?(current_user) ? "/assets/mapStripSignedUp_#{markerSize}.png" : "/assets/mapStripAvail_#{markerSize}.png" %>) 0px <%= -i*dimension %>px">&nbsp;
        </div>
        <div class="details">
            <%= render :partial => "events/event", :locals => { :event => event, :description => true, :showLinks => true, :isMobile => mobile } %>
        </div>
    </div>
    <% end %>
<% end %>
<div id="page">
    <%= will_paginate @events, :page_links => false %>
</div>